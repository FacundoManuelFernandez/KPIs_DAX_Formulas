Ratio de Descuentos Especiales (por c/100 Ventas) =
VAR CantVentas =
    CALCULATE(
        COUNTROWS('TablaTransacciones'),
        'TablaTransacciones'[TipoTransaccion] = "Venta"
    )

VAR CantDevoluciones =
    CALCULATE(
        COUNTROWS('TablaTransacciones'),
        'TablaTransacciones'[TipoTransaccion] = "Devolución"
    )

VAR VentasConcretadas =
    CantVentas - CantDevoluciones

VAR DescuentosAplicadosEspeciales =
    CALCULATE(
        COUNTROWS('TablaDescuentos'),
        'TablaClasificacionDescuentos'[Tipo de aplicación] = "Especial",
        'TablaDescuentos'[Estado de descuento] = "Aplicado"
    )

VAR DescuentosAnuladosEspeciales =
    CALCULATE(
        COUNTROWS('TablaDescuentos'),
        'TablaClasificacionDescuentos'[Tipo de aplicación] = "Especial",
        'TablaDescuentos'[Estado de descuento] = "Anulado"
    )

VAR DescuentosConcretadosEspeciales =
    DescuentosAplicadosEspeciales - DescuentosAnuladosEspeciales

RETURN
DIVIDE(DescuentosConcretadosEspeciales, VentasConcretadas, BLANK()) * 100
