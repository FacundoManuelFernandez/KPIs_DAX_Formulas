//Esta fórmula mide el rendimiento de una variable determinada tomando como referencia la cantidad de pagos que tuvo y su participación sobre el monto total facturado.
//Un valor superior a 1 indica que, en promedio, los pagos asociados a esa variable tienen montos más altos que el promedio general.

Índice de rendimiento (monto/pagos concretados) sobre variable "x" =
VAR PagosRealizados = //Creamos una variable que cuenta la cantidad de pagos realizados
    CALCULATE(
        COUNTROWS('TablaPagos'), //Cuenta las filas de la tabla de pagos
        'TablaPagos'[Estado de pago] = "Realizado" //Donde el estado del pago sea "Realizado"
    )
VAR PagosAnulados = //Creamos una variable que cuenta la cantidad de pagos anulados
    CALCULATE(
        COUNTROWS('TablaPagos'),
        'TablaPagos'[Estado de pago] = "Anulado"
    )
VAR PagosConcretados = PagosRealizados - PagosAnulados //Esta variable permite calcular los pagos concretados (realizados - anulados)

VAR SharePagosConcretados = //Calcula el porcentaje que representan los pagos concretados del contexto actual sobre el total general
    DIVIDE(
        PagosConcretados, //Numerador: pagos concretados en el contexto actual de la variable X
        CALCULATE(
            PagosConcretados, //Denominador: pagos concretados totales
            REMOVEFILTERS('TablaClasificacionVariables'[Variable X]) //Elimina los filtros de la variable X para obtener el total general
        )
    )

VAR ShareFacturacion = //Calcula el porcentaje que representa el monto facturado del contexto actual sobre el total general
    DIVIDE(
        SUM('TablaPagos'[$PagoNeto]), //Numerador: monto neto de pagos en el contexto actual
        CALCULATE(
            SUM('TablaPagos'[$PagoNeto]), //Denominador: monto total sin filtrar por variable X
            REMOVEFILTERS('TablaClasificacionVariables'[Variable X])
        )
    )

RETURN
    DIVIDE(ShareFacturacion, SharePagosConcretados) //Devuelve la proporción del share de facturación sobre el share de pagos concretados
